Hash Join  (cost=233616.93..346719.99 rows=538058 width=146)
  Hash Cond: (mc.movie_id = t.id)
  ->  Seq Scan on movie_companies mc  (cost=0.00..51404.11 rows=2426229 width=40) (actual time=0.032..1266.080 rows=2425357 loops=1)
        Filter: (company_id < 118924)
        Rows Removed by Filter: 183772
  ->  Hash  (cost=217297.64..217297.64 rows=560744 width=106) (actual time=4448.738..4448.738 rows=103396 loops=1)
        Buckets: 32768  Batches: 32  Memory Usage: 696kB
        ->  Hash Join  (cost=93730.26..217297.64 rows=560744 width=106) (actual time=2654.584..4385.820 rows=103396 loops=1)
              Hash Cond: (mk.movie_id = t.id)
              ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=1943684 width=12) (actual time=0.022..1703.704 rows=1953503 loops=1)
                    Filter: (keyword_id < 3401)
                    Rows Removed by Filter: 2570427
              ->  Hash  (cost=73925.90..73925.90 rows=729468 width=94) (actual time=1679.473..1679.473 rows=638430 loops=1)
                    Buckets: 32768  Batches: 32  Memory Usage: 2532kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=729468 width=94) (actual time=0.010..1416.273 rows=638430 loops=1)
                          Filter: ((production_year < 2003) AND (kind_id = 7))
                          Rows Removed by Filter: 1889882
Planning time: 10.185 ms
Execution time: 6971.417 ms
