Hash Join  (cost=153110.96..1545672.28 rows=439316 width=176)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..614943.12 rows=36225612 width=42) (actual time=0.018..12469.606 rows=36244344 loops=1)
  ->  Hash  (cost=152128.66..152128.66 rows=30664 width=134) (actual time=3052.218..3052.218 rows=67217 loops=1)
        Buckets: 32768 (originally 32768)  Batches: 4 (originally 2)  Memory Usage: 3841kB
        ->  Hash Join  (cost=76466.39..152128.66 rows=30664 width=134) (actual time=1511.409..3000.007 rows=67217 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=828718 width=40) (actual time=0.014..1135.772 rows=621291 loops=1)
                    Filter: ((company_id > 3139) AND (company_type_id < 2))
                    Rows Removed by Filter: 1987838
              ->  Hash  (cost=73925.90..73925.90 rows=93559 width=94) (actual time=1510.932..1510.932 rows=104574 loops=1)
                    Buckets: 32768  Batches: 4  Memory Usage: 3177kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=93559 width=94) (actual time=598.392..1473.046 rows=104574 loops=1)
                          Filter: ((production_year < 2011) AND (kind_id = 4))
                          Rows Removed by Filter: 2423738
Planning time: 5.079 ms
Execution time: 32227.247 ms
