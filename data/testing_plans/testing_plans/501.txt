Hash Join  (cost=283727.15..1861119.74 rows=17011040 width=148)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..614943.12 rows=36225612 width=42) (actual time=0.006..13097.736 rows=36244344 loops=1)
  ->  Hash  (cost=249172.14..249172.14 rows=1187361 width=106) (actual time=5773.351..5773.351 rows=632406 loops=1)
        Buckets: 32768  Batches: 64  Memory Usage: 1617kB
        ->  Hash Join  (cost=100912.05..249172.14 rows=1187361 width=106) (actual time=1969.748..5434.396 rows=632406 loops=1)
              Hash Cond: (mk.movie_id = t.id)
              ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=3020360 width=12) (actual time=0.018..1798.798 rows=3001669 loops=1)
                    Filter: (keyword_id < 10571)
                    Rows Removed by Filter: 1522261
              ->  Hash  (cost=73925.90..73925.90 rows=994012 width=94) (actual time=1964.613..1964.613 rows=923721 loops=1)
                    Buckets: 32768  Batches: 64  Memory Usage: 1899kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=994012 width=94) (actual time=0.021..1527.933 rows=923721 loops=1)
                          Filter: ((kind_id > 1) AND (production_year < 2005))
                          Rows Removed by Filter: 1604591
Planning time: 1.477 ms
Execution time: 45218.314 ms
