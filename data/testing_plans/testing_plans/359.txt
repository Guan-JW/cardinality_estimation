Hash Join  (cost=807621.38..934853.57 rows=81803 width=148)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=2743365 width=12) (actual time=0.015..1662.600 rows=2740935 loops=1)
        Filter: (keyword_id < 7776)
        Rows Removed by Filter: 1782995
  ->  Hash  (cost=805205.92..805205.92 rows=75397 width=136) (actual time=16824.504..16824.504 rows=60640 loops=1)
        Buckets: 32768  Batches: 4  Memory Usage: 2367kB
        ->  Hash Join  (cost=74288.34..805205.92 rows=75397 width=136) (actual time=2923.316..16622.507 rows=60640 loops=1)
              Hash Cond: (ci.movie_id = t.id)
              ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=6575055 width=42) (actual time=1744.290..13617.582 rows=6496430 loops=1)
                    Filter: (person_id < 627326)
                    Rows Removed by Filter: 29747914
              ->  Hash  (cost=73925.90..73925.90 rows=28995 width=94) (actual time=1178.760..1178.760 rows=19956 loops=1)
                    Buckets: 32768  Batches: 1  Memory Usage: 2453kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=28995 width=94) (actual time=0.032..1169.170 rows=19956 loops=1)
                          Filter: ((kind_id < 4) AND (production_year = 2004))
                          Rows Removed by Filter: 2508356
Planning time: 2.196 ms
Execution time: 19691.438 ms
