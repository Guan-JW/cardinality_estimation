Hash Join  (cost=272646.28..1548596.67 rows=5662028 width=176)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..796071.18 rows=19160782 width=42) (actual time=0.026..19907.992 rows=16798902 loops=1)
        Filter: ((person_id < 2984481) AND (role_id > 1))
        Rows Removed by Filter: 19445442
  ->  Hash  (cost=248712.50..248712.50 rows=747182 width=134) (actual time=6068.698..6068.698 rows=964302 loops=1)
        Buckets: 32768  Batches: 64  Memory Usage: 2195kB
        ->  Hash Join  (cost=129928.86..248712.50 rows=747182 width=134) (actual time=2439.921..5479.459 rows=964302 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=747182 width=40) (actual time=106.830..1146.368 rows=964302 loops=1)
                    Filter: ((company_id > 8558) AND (company_type_id > 1))
                    Rows Removed by Filter: 1644827
              ->  Hash  (cost=61283.27..61283.27 rows=2528527 width=94) (actual time=2332.202..2332.202 rows=2528312 loops=1)
                    Buckets: 32768  Batches: 128  Memory Usage: 2453kB
                    ->  Seq Scan on title t  (cost=0.00..61283.27 rows=2528527 width=94) (actual time=0.027..1168.823 rows=2528312 loops=1)
Planning time: 1.520 ms
Execution time: 41369.594 ms
