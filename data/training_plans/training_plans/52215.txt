Hash Join  (cost=251078.67..1517460.84 rows=18232492 width=0) (actual time=5567.512..39032.488 rows=13444308 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..614943.12 rows=36225612 width=4) (actual time=0.021..13502.433 rows=36244344 loops=1)
  ->  Hash  (cost=230198.95..230198.95 rows=1272618 width=8) (actual time=5566.116..5566.116 rows=327903 loops=1)
        Buckets: 131072  Batches: 32  Memory Usage: 1439kB
        ->  Hash Join  (cost=87146.10..230198.95 rows=1272618 width=8) (actual time=1664.673..5471.295 rows=327903 loops=1)
              Hash Cond: (mk.movie_id = t.id)
              ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=3993477 width=4) (actual time=0.025..1897.176 rows=4004501 loops=1)
                    Filter: (keyword_id < 34839)
                    Rows Removed by Filter: 519429
              ->  Hash  (cost=73925.90..73925.90 rows=805776 width=4) (actual time=1663.840..1663.840 rows=881945 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 2976kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=805776 width=4) (actual time=344.779..1382.595 rows=881945 loops=1)
                          Filter: ((production_year > 2001) AND (kind_id = 7))
                          Rows Removed by Filter: 1646367
Planning time: 0.788 ms
Execution time: 40460.776 ms
