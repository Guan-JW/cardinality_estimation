Hash Join  (cost=175399.18..274283.74 rows=233759 width=0) (actual time=3474.950..6280.239 rows=432009 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=1174091 width=4) (actual time=0.032..1425.906 rows=1175560 loops=1)
        Filter: (keyword_id < 1389)
        Rows Removed by Filter: 3348370
  ->  Hash  (cost=167139.38..167139.38 rows=503424 width=8) (actual time=3474.098..3474.098 rows=299699 loops=1)
        Buckets: 131072  Batches: 8  Memory Usage: 2494kB
        ->  Hash Join  (cost=87180.69..167139.38 rows=503424 width=8) (actual time=1618.550..3388.433 rows=299699 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=1066805 width=4) (actual time=0.028..1096.398 rows=813523 loops=1)
                    Filter: ((company_id < 73273) AND (company_type_id > 1))
                    Rows Removed by Filter: 1795606
              ->  Hash  (cost=67604.59..67604.59 rows=1193208 width=4) (actual time=1617.474..1617.474 rows=1192518 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 3646kB
                    ->  Seq Scan on title t  (cost=0.00..67604.59 rows=1193208 width=4) (actual time=0.017..1243.898 rows=1192518 loops=1)
                          Filter: (production_year > 2003)
                          Rows Removed by Filter: 1335794
Planning time: 1.165 ms
Execution time: 6329.385 ms
