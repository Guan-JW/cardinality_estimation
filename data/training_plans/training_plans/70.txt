Hash Join  (cost=887664.25..1025775.46 rows=77326 width=148) (actual time=20122.981..23614.740 rows=1679204 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..69693.30 rows=4523930 width=12) (actual time=0.019..1374.715 rows=4523930 loops=1)
  ->  Hash  (cost=886279.02..886279.02 rows=43219 width=136) (actual time=20122.014..20122.014 rows=36855 loops=1)
        Buckets: 32768  Batches: 2  Memory Usage: 3085kB
        ->  Hash Join  (cost=74255.97..886279.02 rows=43219 width=136) (actual time=12482.633..19805.041 rows=36855 loops=1)
              Hash Cond: (ci.movie_id = t.id)
              ->  Seq Scan on cast_info ci  (cost=0.00..796071.18 rows=4138581 width=42) (actual time=11099.029..17540.672 rows=2962202 loops=1)
                    Filter: ((person_id < 3759296) AND (role_id = 10))
                    Rows Removed by Filter: 33282142
              ->  Hash  (cost=73925.90..73925.90 rows=26405 width=94) (actual time=1383.238..1383.238 rows=23926 loops=1)
                    Buckets: 32768  Batches: 1  Memory Usage: 2906kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=26405 width=94) (actual time=0.049..1372.471 rows=23926 loops=1)
                          Filter: ((kind_id < 7) AND (production_year = 2003))
                          Rows Removed by Filter: 2504386
Planning time: 1.403 ms
Execution time: 23708.510 ms
