Hash Join  (cost=123796.32..223798.58 rows=83926 width=0) (actual time=6764.244..12136.699 rows=93171 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=1523433 width=4) (actual time=0.024..4496.785 rows=1533511 loops=1)
        Filter: (keyword_id < 2238)
        Rows Removed by Filter: 2990419
  ->  Hash  (cost=121510.12..121510.12 rows=139296 width=8) (actual time=6762.698..6762.698 rows=82205 loops=1)
        Buckets: 131072  Batches: 2  Memory Usage: 2637kB
        ->  Hash Join  (cost=86650.76..121510.12 rows=139296 width=8) (actual time=4810.024..6730.464 rows=82205 loops=1)
              Hash Cond: (mi_idx.movie_id = t.id)
              ->  Seq Scan on movie_info_idx mi_idx  (cost=0.00..25185.44 rows=454124 width=4) (actual time=0.011..1462.370 rows=459925 loops=1)
                    Filter: (info_type_id = 100)
                    Rows Removed by Filter: 920110
              ->  Hash  (cost=73925.90..73925.90 rows=775588 width=4) (actual time=4808.792..4808.792 rows=838642 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 2873kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=775588 width=4) (actual time=0.012..4471.178 rows=838642 loops=1)
                          Filter: ((kind_id > 2) AND (production_year > 2004))
                          Rows Removed by Filter: 1689670
Planning time: 3.855 ms
Execution time: 12161.514 ms
