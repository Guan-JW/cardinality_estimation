Hash Join  (cost=974103.20..1108127.64 rows=1554289 width=0) (actual time=42616.356..50600.787 rows=3592325 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=2432484 width=4) (actual time=0.014..5028.122 rows=2435334 loops=1)
        Filter: (keyword_id < 5777)
        Rows Removed by Filter: 2088596
  ->  Hash  (cost=947595.48..947595.48 rows=1615658 width=8) (actual time=42615.689..42615.689 rows=551126 loops=1)
        Buckets: 131072  Batches: 32  Memory Usage: 1712kB
        ->  Hash Join  (cost=102767.86..947595.48 rows=1615658 width=8) (actual time=6205.291..42384.140 rows=551126 loops=1)
              Hash Cond: (ci.movie_id = t.id)
              ->  Seq Scan on cast_info ci  (cost=0.00..796071.18 rows=1615658 width=4) (actual time=1012.749..36114.426 rows=551126 loops=1)
                    Filter: ((person_id < 969285) AND (role_id > 8))
                    Rows Removed by Filter: 35693218
              ->  Hash  (cost=61283.27..61283.27 rows=2528527 width=4) (actual time=5184.801..5184.801 rows=2528312 loops=1)
                    Buckets: 131072  Batches: 64  Memory Usage: 2415kB
                    ->  Seq Scan on title t  (cost=0.00..61283.27 rows=2528527 width=4) (actual time=0.021..4057.143 rows=2528312 loops=1)
Planning time: 1.082 ms
Execution time: 51134.845 ms
