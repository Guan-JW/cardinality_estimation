Hash Join  (cost=892622.21..1493555.50 rows=9625246 width=0) (actual time=19217.422..37198.826 rows=14696434 loops=1)
  Hash Cond: (mi.movie_id = t.id)
  ->  Seq Scan on movie_info mi  (cost=0.00..309384.22 rows=14739122 width=4) (actual time=0.018..6222.288 rows=14835720 loops=1)
  ->  Hash  (cost=865530.82..865530.82 rows=1651231 width=8) (actual time=19193.465..19193.465 rows=2409423 loops=1)
        Buckets: 131072  Batches: 32  Memory Usage: 3933kB
        ->  Hash Join  (cost=89780.46..865530.82 rows=1651231 width=8) (actual time=11026.063..18498.815 rows=2409423 loops=1)
              Hash Cond: (ci.movie_id = t.id)
              ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=4320508 width=4) (actual time=9360.581..13594.596 rows=4323018 loops=1)
                    Filter: (role_id = 10)
                    Rows Removed by Filter: 31921326
              ->  Hash  (cost=73925.90..73925.90 rows=966364 width=4) (actual time=1664.227..1664.227 rows=1056944 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 3356kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=966364 width=4) (actual time=0.800..1336.968 rows=1056944 loops=1)
                          Filter: ((kind_id > 4) AND (production_year > 1996))
                          Rows Removed by Filter: 1471368
Planning time: 1.184 ms
Execution time: 38883.313 ms
