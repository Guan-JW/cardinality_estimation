Hash Join  (cost=152084.24..190772.72 rows=58000 width=0) (actual time=2988.163..4245.278 rows=585126 loops=1)
  Hash Cond: (mi_idx.movie_id = t.id)
  ->  Seq Scan on movie_info_idx mi_idx  (cost=0.00..21735.35 rows=1380035 width=4) (actual time=0.024..427.659 rows=1380035 loops=1)
  ->  Hash  (cost=150339.88..150339.88 rows=106269 width=8) (actual time=2987.338..2987.338 rows=353871 loops=1)
        Buckets: 131072 (originally 131072)  Batches: 8 (originally 2)  Memory Usage: 3073kB
        ->  Hash Join  (cost=83849.26..150339.88 rows=106269 width=8) (actual time=1889.977..2860.320 rows=353871 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=444266 width=4) (actual time=230.666..870.914 rows=769743 loops=1)
                    Filter: ((company_id > 22984) AND (company_type_id > 1))
                    Rows Removed by Filter: 1839386
              ->  Hash  (cost=73925.90..73925.90 rows=604828 width=4) (actual time=1391.492..1391.492 rows=490018 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 3190kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=604828 width=4) (actual time=19.952..1239.598 rows=490018 loops=1)
                          Filter: ((production_year > 1951) AND (kind_id = 1))
                          Rows Removed by Filter: 2038294
Planning time: 1.176 ms
Execution time: 4322.682 ms
