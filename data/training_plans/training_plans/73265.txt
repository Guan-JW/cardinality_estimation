Hash Join  (cost=235014.75..1201093.95 rows=6903419 width=0) (actual time=9823.633..27868.399 rows=4029335 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=16201301 width=4) (actual time=5091.172..15219.527 rows=16121683 loops=1)
        Filter: (role_id > 2)
        Rows Removed by Filter: 20122661
  ->  Hash  (cost=217338.10..217338.10 rows=1077412 width=8) (actual time=4730.844..4730.844 rows=260865 loops=1)
        Buckets: 131072  Batches: 16  Memory Usage: 1667kB
        ->  Hash Join  (cost=90606.68..217338.10 rows=1077412 width=8) (actual time=2518.123..4668.325 rows=260865 loops=1)
              Hash Cond: (mk.movie_id = t.id)
              ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=2679513 width=4) (actual time=0.023..1668.610 rows=2666131 loops=1)
                    Filter: (keyword_id > 3093)
                    Rows Removed by Filter: 1857799
              ->  Hash  (cost=73925.90..73925.90 rows=1016702 width=4) (actual time=1736.081..1736.081 rows=960113 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 3141kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=1016702 width=4) (actual time=0.030..1419.147 rows=960113 loops=1)
                          Filter: ((production_year < 2008) AND (kind_id = 7))
                          Rows Removed by Filter: 1568199
Planning time: 3.801 ms
Execution time: 28236.854 ms
