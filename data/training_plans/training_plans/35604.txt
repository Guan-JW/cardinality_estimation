Hash Join  (cost=129990.29..1191073.98 rows=2655550 width=0) (actual time=2639.720..30685.727 rows=3405602 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..614943.12 rows=36225612 width=4) (actual time=0.014..13112.954 rows=36244344 loops=1)
  ->  Hash  (cost=126948.35..126948.35 rows=185356 width=8) (actual time=2638.945..2638.945 rows=103238 loops=1)
        Buckets: 131072  Batches: 4  Memory Usage: 2032kB
        ->  Hash Join  (cost=90606.68..126948.35 rows=185356 width=8) (actual time=1706.603..2605.896 rows=103238 loops=1)
              Hash Cond: (mi_idx.movie_id = t.id)
              ->  Seq Scan on movie_info_idx mi_idx  (cost=0.00..25185.44 rows=460978 width=4) (actual time=0.016..470.344 rows=459925 loops=1)
                    Filter: (info_type_id = 99)
                    Rows Removed by Filter: 920110
              ->  Hash  (cost=73925.90..73925.90 rows=1016702 width=4) (actual time=1705.710..1705.710 rows=960113 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 3135kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=1016702 width=4) (actual time=0.021..1401.791 rows=960113 loops=1)
                          Filter: ((production_year < 2008) AND (kind_id = 7))
                          Rows Removed by Filter: 1568199
Planning time: 1.205 ms
Execution time: 31086.338 ms
