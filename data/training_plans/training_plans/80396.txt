Hash Join  (cost=467296.16..1290671.18 rows=538397 width=0) (actual time=13273.887..24197.752 rows=1630905 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=7298253 width=4) (actual time=4186.751..11662.229 rows=7451973 loops=1)
        Filter: (role_id = 2)
        Rows Removed by Filter: 28792371
  ->  Hash  (cost=464235.52..464235.52 rows=186531 width=8) (actual time=9084.914..9084.914 rows=252669 loops=1)
        Buckets: 131072  Batches: 4  Memory Usage: 3514kB
        ->  Hash Join  (cost=74456.32..464235.52 rows=186531 width=8) (actual time=1002.084..8430.323 rows=252669 loops=1)
              Hash Cond: (mi.movie_id = t.id)
              ->  Seq Scan on movie_info mi  (cost=0.00..346232.03 rows=11115165 width=4) (actual time=38.470..5034.127 rows=11210743 loops=1)
                    Filter: (info_type_id > 3)
                    Rows Removed by Filter: 3624977
              ->  Hash  (cost=73925.90..73925.90 rows=42433 width=4) (actual time=878.544..878.544 rows=37411 loops=1)
                    Buckets: 65536  Batches: 1  Memory Usage: 1828kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=42433 width=4) (actual time=69.286..863.151 rows=37411 loops=1)
                          Filter: ((kind_id = 1) AND (production_year = 2011))
                          Rows Removed by Filter: 2490901
Planning time: 1.331 ms
Execution time: 24372.033 ms
