Hash Join  (cost=144457.06..1255022.78 rows=6047571 width=0) (actual time=7751.108..82885.387 rows=9299856 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=29627168 width=4) (actual time=0.013..48168.800 rows=29561710 loops=1)
        Filter: (person_id < 2991639)
        Rows Removed by Filter: 6682634
  ->  Hash  (cost=135988.45..135988.45 rows=516129 width=8) (actual time=7749.930..7749.930 rows=390303 loops=1)
        Buckets: 131072  Batches: 8  Memory Usage: 2942kB
        ->  Hash Join  (cost=89440.68..135988.45 rows=516129 width=8) (actual time=4597.478..7605.640 rows=390303 loops=1)
              Hash Cond: (mi_idx.movie_id = t.id)
              ->  Seq Scan on movie_info_idx mi_idx  (cost=0.00..21735.35 rows=1380035 width=4) (actual time=0.014..1872.073 rows=1380035 loops=1)
              ->  Hash  (cost=73925.90..73925.90 rows=945662 width=4) (actual time=4596.557..4596.557 rows=870610 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 2940kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=945662 width=4) (actual time=0.013..4214.519 rows=870610 loops=1)
                          Filter: ((kind_id > 2) AND (production_year < 2005))
                          Rows Removed by Filter: 1657702
Planning time: 3.890 ms
Execution time: 84270.467 ms
