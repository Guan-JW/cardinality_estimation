Hash Join  (cost=179621.21..1168404.96 rows=3522415 width=0) (actual time=4262.790..29814.925 rows=10410667 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..796071.18 rows=13395844 width=4) (actual time=0.026..16671.985 rows=9769393 loops=1)
        Filter: ((person_id < 3018469) AND (role_id > 2))
        Rows Removed by Filter: 26474951
  ->  Hash  (cost=168712.31..168712.31 rows=664872 width=8) (actual time=4261.953..4261.953 rows=1001058 loops=1)
        Buckets: 131072  Batches: 16  Memory Usage: 3444kB
        ->  Hash Join  (cost=84497.07..168712.31 rows=664872 width=8) (actual time=1332.307..3968.061 rows=1001058 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..44881.29 rows=2609129 width=4) (actual time=0.012..1009.443 rows=2609129 loops=1)
              ->  Hash  (cost=73925.90..73925.90 rows=644333 width=4) (actual time=1331.288..1331.288 rows=544419 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 2215kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=644333 width=4) (actual time=0.025..1156.329 rows=544419 loops=1)
                          Filter: ((kind_id < 7) AND (production_year > 1994))
                          Rows Removed by Filter: 1983893
Planning time: 1.182 ms
Execution time: 31064.723 ms
