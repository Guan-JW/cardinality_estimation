Nested Loop  (cost=440634.87..448110.26 rows=731 width=0) (actual time=21187.541..21384.764 rows=593 loops=1)
  Join Filter: (mc.movie_id = t.id)
  ->  Merge Join  (cost=440634.44..442434.48 rows=5727 width=8) (actual time=21161.920..21337.908 rows=619 loops=1)
        Merge Cond: (mi.movie_id = mc.movie_id)
        ->  Sort  (cost=382171.79..383022.98 rows=340474 width=4) (actual time=18511.010..18613.161 rows=313662 loops=1)
              Sort Key: mi.movie_id
              Sort Method: external sort  Disk: 4504kB
              ->  Seq Scan on movie_info mi  (cost=0.00..346232.03 rows=340474 width=4) (actual time=2554.797..17810.988 rows=328857 loops=1)
                    Filter: (info_type_id = 98)
                    Rows Removed by Filter: 14506863
        ->  Sort  (cost=58462.30..58482.88 rows=8232 width=4) (actual time=2644.865..2646.147 rows=8084 loops=1)
              Sort Key: mc.movie_id
              Sort Method: quicksort  Memory: 571kB
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=8232 width=4) (actual time=540.853..2637.922 rows=8081 loops=1)
                    Filter: ((company_id = 166) AND (company_type_id = 1))
                    Rows Removed by Filter: 2601048
  ->  Index Scan using title_pkey on title t  (cost=0.43..0.98 rows=1 width=4) (actual time=0.074..0.074 rows=1 loops=619)
        Index Cond: (id = mi.movie_id)
        Filter: (kind_id > 3)
        Rows Removed by Filter: 0
Planning time: 3.019 ms
Execution time: 21390.589 ms
