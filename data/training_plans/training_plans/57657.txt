Hash Join  (cost=136633.02..225480.85 rows=33613 width=0) (actual time=2409.564..4147.156 rows=401074 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=2002286 width=4) (actual time=0.011..1330.560 rows=2005627 loops=1)
        Filter: (keyword_id < 3570)
        Rows Removed by Filter: 2518303
  ->  Hash  (cost=136102.44..136102.44 rows=42447 width=8) (actual time=2409.127..2409.127 rows=24000 loops=1)
        Buckets: 65536  Batches: 1  Memory Usage: 1450kB
        ->  Hash Join  (cost=79111.30..136102.44 rows=42447 width=8) (actual time=1352.214..2399.937 rows=24000 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..51404.11 rows=339613 width=4) (actual time=0.026..809.520 rows=334457 loops=1)
                    Filter: (company_id < 166)
                    Rows Removed by Filter: 2274672
              ->  Hash  (cost=73925.90..73925.90 rows=316032 width=4) (actual time=1351.277..1351.277 rows=400740 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 2793kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=316032 width=4) (actual time=0.064..1231.975 rows=400740 loops=1)
                          Filter: ((production_year < 2003) AND (kind_id = 1))
                          Rows Removed by Filter: 2127572
Planning time: 1.058 ms
Execution time: 4193.688 ms
