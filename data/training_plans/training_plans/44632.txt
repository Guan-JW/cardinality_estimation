Hash Join  (cost=153769.19..280149.97 rows=359374 width=0) (actual time=3755.040..7765.364 rows=4393572 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..69693.30 rows=4523930 width=4) (actual time=0.025..1432.722 rows=4523930 loops=1)
  ->  Hash  (cost=150473.42..150473.42 rows=200862 width=8) (actual time=3475.695..3475.695 rows=436180 loops=1)
        Buckets: 131072 (originally 131072)  Batches: 8 (originally 4)  Memory Usage: 3176kB
        ->  Hash Join  (cost=80193.64..150473.42 rows=200862 width=8) (actual time=1874.957..3290.782 rows=436180 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..51404.11 rows=1329612 width=4) (actual time=289.235..1006.144 rows=1334883 loops=1)
                    Filter: (company_type_id > 1)
                    Rows Removed by Filter: 1274246
              ->  Hash  (cost=73925.90..73925.90 rows=381979 width=4) (actual time=1224.172..1224.172 rows=440029 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 2968kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=381979 width=4) (actual time=107.464..1086.563 rows=440029 loops=1)
                          Filter: ((kind_id < 2) AND (production_year < 2006))
                          Rows Removed by Filter: 2088283
Planning time: 1.167 ms
Execution time: 8274.743 ms
