Hash Join  (cost=144204.11..269669.65 rows=284250 width=0) (actual time=2517.134..6338.266 rows=1986370 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..69693.30 rows=4523930 width=4) (actual time=0.019..1121.743 rows=4523930 loops=1)
  ->  Hash  (cost=141597.19..141597.19 rows=158874 width=8) (actual time=2516.108..2516.108 rows=237544 loops=1)
        Buckets: 131072  Batches: 4  Memory Usage: 3366kB
        ->  Hash Join  (cost=79303.65..141597.19 rows=158874 width=8) (actual time=1196.156..2430.937 rows=237544 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..51404.11 rows=563383 width=4) (actual time=0.036..735.738 rows=561678 loops=1)
                    Filter: (company_id < 596)
                    Rows Removed by Filter: 2047451
              ->  Hash  (cost=67604.59..67604.59 rows=713045 width=4) (actual time=1194.760..1194.760 rows=707186 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 2578kB
                    ->  Seq Scan on title t  (cost=0.00..67604.59 rows=713045 width=4) (actual time=0.023..967.964 rows=707186 loops=1)
                          Filter: (production_year < 1991)
                          Rows Removed by Filter: 1821126
Planning time: 1.110 ms
Execution time: 6573.406 ms
