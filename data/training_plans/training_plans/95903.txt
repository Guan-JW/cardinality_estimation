Hash Join  (cost=144434.07..241690.69 rows=98225 width=0) (actual time=2636.518..5643.622 rows=953040 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=4072333 width=4) (actual time=0.025..1319.516 rows=4073770 loops=1)
        Filter: (keyword_id < 39437)
        Rows Removed by Filter: 450160
  ->  Hash  (cost=143671.72..143671.72 rows=60988 width=8) (actual time=2635.574..2635.574 rows=228822 loops=1)
        Buckets: 131072 (originally 65536)  Batches: 4 (originally 1)  Memory Usage: 3263kB
        ->  Hash Join  (cost=75829.68..143671.72 rows=60988 width=8) (actual time=982.676..2550.724 rows=228822 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..51404.11 rows=1329612 width=4) (actual time=5.941..872.141 rows=1334883 loops=1)
                    Filter: (company_type_id = 2)
                    Rows Removed by Filter: 1274246
              ->  Hash  (cost=73925.90..73925.90 rows=115982 width=4) (actual time=975.067..975.067 rows=239442 loops=1)
                    Buckets: 131072 (originally 131072)  Batches: 4 (originally 2)  Memory Usage: 3130kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=115982 width=4) (actual time=0.028..887.340 rows=239442 loops=1)
                          Filter: ((kind_id < 3) AND (production_year < 1971))
                          Rows Removed by Filter: 2288870
Planning time: 1.142 ms
Execution time: 5733.441 ms
