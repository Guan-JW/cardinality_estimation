Hash Join  (cost=283526.79..396436.94 rows=2148649 width=0) (actual time=4565.912..9324.643 rows=17058474 loops=1)
  Hash Cond: (mc.movie_id = t.id)
  ->  Seq Scan on movie_companies mc  (cost=0.00..51404.11 rows=2446309 width=4) (actual time=0.016..740.377 rows=2447857 loops=1)
        Filter: (company_id < 127257)
        Rows Removed by Filter: 161272
  ->  Hash  (cost=247090.01..247090.01 rows=2220863 width=8) (actual time=4564.173..4564.173 rows=2211611 loops=1)
        Buckets: 131072  Batches: 32  Memory Usage: 3707kB
        ->  Hash Join  (cost=102767.86..247090.01 rows=2220863 width=8) (actual time=1319.678..4050.458 rows=2211611 loops=1)
              Hash Cond: (mk.movie_id = t.id)
              ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=2220863 width=4) (actual time=0.020..1041.535 rows=2211611 loops=1)
                    Filter: (keyword_id > 4966)
                    Rows Removed by Filter: 2312319
              ->  Hash  (cost=61283.27..61283.27 rows=2528527 width=4) (actual time=1317.978..1317.978 rows=2528312 loops=1)
                    Buckets: 131072  Batches: 64  Memory Usage: 2425kB
                    ->  Seq Scan on title t  (cost=0.00..61283.27 rows=2528527 width=4) (actual time=0.019..620.862 rows=2528312 loops=1)
Planning time: 1.142 ms
Execution time: 10755.463 ms
