Hash Join  (cost=262870.68..1180054.69 rows=2977158 width=148) (actual time=15917.824..31764.614 rows=8564908 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=7298253 width=42) (actual time=8804.846..16263.596 rows=7451973 loops=1)
        Filter: (role_id = 2)
        Rows Removed by Filter: 28792371
  ->  Hash  (cost=232853.48..232853.48 rows=1031456 width=106) (actual time=7110.664..7110.664 rows=1419808 loops=1)
        Buckets: 32768  Batches: 64  Memory Usage: 3030kB
        ->  Hash Join  (cost=83255.89..232853.48 rows=1031456 width=106) (actual time=1721.052..6244.879 rows=1419808 loops=1)
              Hash Cond: (mk.movie_id = t.id)
              ->  Seq Scan on movie_keyword mk  (cost=0.00..69693.30 rows=4523930 width=12) (actual time=0.032..1388.592 rows=4523930 loops=1)
              ->  Hash  (cost=67604.59..67604.59 rows=576504 width=94) (actual time=1720.464..1720.464 rows=568449 loops=1)
                    Buckets: 32768  Batches: 32  Memory Usage: 2235kB
                    ->  Seq Scan on title t  (cost=0.00..67604.59 rows=576504 width=94) (actual time=0.022..1462.926 rows=568449 loops=1)
                          Filter: (production_year < 1984)
                          Rows Removed by Filter: 1959863
Planning time: 1.344 ms
Execution time: 32254.049 ms
