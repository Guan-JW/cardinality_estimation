Hash Join  (cost=149491.62..1211294.04 rows=3528989 width=0) (actual time=2923.912..30045.476 rows=5240455 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=27653425 width=4) (actual time=0.022..13775.377 rows=27758030 loops=1)
        Filter: (role_id < 6)
        Rows Removed by Filter: 8486314
  ->  Hash  (cost=144197.15..144197.15 rows=322678 width=8) (actual time=2923.131..2923.131 rows=249986 loops=1)
        Buckets: 131072  Batches: 8  Memory Usage: 2248kB
        ->  Hash Join  (cost=102964.04..144197.15 rows=322678 width=8) (actual time=1830.885..2850.216 rows=249986 loops=1)
              Hash Cond: (mi_idx.movie_id = t.id)
              ->  Seq Scan on movie_info_idx mi_idx  (cost=0.00..25185.44 rows=460978 width=4) (actual time=0.012..417.323 rows=459925 loops=1)
                    Filter: (info_type_id = 99)
                    Rows Removed by Filter: 920110
              ->  Hash  (cost=73925.90..73925.90 rows=1769931 width=4) (actual time=1829.721..1829.721 rows=1799906 loops=1)
                    Buckets: 131072  Batches: 32  Memory Usage: 3007kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=1769931 width=4) (actual time=0.023..1249.238 rows=1799906 loops=1)
                          Filter: ((kind_id > 1) AND (production_year > 1914))
                          Rows Removed by Filter: 728406
Planning time: 1.236 ms
Execution time: 30622.076 ms
