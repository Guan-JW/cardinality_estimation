Hash Join  (cost=124081.70..250354.26 rows=350453 width=0) (actual time=2433.769..7162.349 rows=5477992 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..69693.30 rows=4523930 width=4) (actual time=0.024..1146.286 rows=4523930 loops=1)
  ->  Hash  (cost=120867.25..120867.25 rows=195876 width=8) (actual time=2432.675..2432.675 rows=456205 loops=1)
        Buckets: 131072 (originally 131072)  Batches: 8 (originally 4)  Memory Usage: 3274kB
        ->  Hash Join  (cost=79814.01..120867.25 rows=195876 width=8) (actual time=1044.600..2280.904 rows=456205 loops=1)
              Hash Cond: (mi_idx.movie_id = t.id)
              ->  Seq Scan on movie_info_idx mi_idx  (cost=0.00..21735.35 rows=1380035 width=4) (actual time=0.034..396.868 rows=1380035 loops=1)
              ->  Hash  (cost=73925.90..73925.90 rows=358888 width=4) (actual time=1043.620..1043.620 rows=447524 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 3002kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=358888 width=4) (actual time=0.023..903.079 rows=447524 loops=1)
                          Filter: ((kind_id < 3) AND (production_year < 2003))
                          Rows Removed by Filter: 2080788
Planning time: 1.166 ms
Execution time: 7726.502 ms
