Hash Join  (cost=164432.52..261224.56 rows=115714 width=0) (actual time=2754.457..5105.298 rows=328286 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=3901807 width=4) (actual time=0.018..1223.143 rows=3899134 loops=1)
        Filter: (keyword_id < 29320)
        Rows Removed by Filter: 624796
  ->  Hash  (cost=163495.18..163495.18 rows=74987 width=8) (actual time=2753.130..2753.130 rows=147484 loops=1)
        Buckets: 131072 (originally 131072)  Batches: 2 (originally 1)  Memory Usage: 3901kB
        ->  Hash Join  (cost=97651.71..163495.18 rows=74987 width=8) (actual time=1770.537..2710.622 rows=147484 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=131112 width=4) (actual time=0.026..637.596 rows=201168 loops=1)
                    Filter: ((company_id < 137) AND (company_type_id < 2))
                    Rows Removed by Filter: 2407961
              ->  Hash  (cost=73925.90..73925.90 rows=1446144 width=4) (actual time=1769.540..1769.540 rows=1429781 loops=1)
                    Buckets: 131072  Batches: 32  Memory Usage: 2594kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=1446144 width=4) (actual time=0.013..1299.021 rows=1429781 loops=1)
                          Filter: ((kind_id > 2) AND (production_year < 2011))
                          Rows Removed by Filter: 1098531
Planning time: 1.256 ms
Execution time: 5146.212 ms
