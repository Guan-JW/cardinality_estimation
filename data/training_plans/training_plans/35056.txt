Hash Join  (cost=153772.69..1012071.40 rows=523784 width=0) (actual time=8805.031..60669.068 rows=931140 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=12726058 width=4) (actual time=0.026..44651.176 rows=12670688 loops=1)
        Filter: (role_id = 1)
        Rows Removed by Filter: 23573656
  ->  Hash  (cost=152064.82..152064.82 rows=104070 width=8) (actual time=8804.269..8804.269 rows=151499 loops=1)
        Buckets: 131072  Batches: 2  Memory Usage: 3964kB
        ->  Hash Join  (cost=75580.59..152064.82 rows=104070 width=8) (actual time=4229.557..8747.000 rows=151499 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..44881.29 rows=2609129 width=4) (actual time=0.015..3478.223 rows=2609129 loops=1)
              ->  Hash  (cost=73925.90..73925.90 rows=100855 width=4) (actual time=3945.165..3945.165 rows=111586 loops=1)
                    Buckets: 131072  Batches: 2  Memory Usage: 2982kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=100855 width=4) (actual time=517.547..3870.727 rows=111586 loops=1)
                          Filter: ((production_year < 2012) AND (kind_id = 4))
                          Rows Removed by Filter: 2416726
Planning time: 1.221 ms
Execution time: 60839.971 ms
