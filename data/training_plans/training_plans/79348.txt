Hash Join  (cost=921112.84..1064543.55 rows=959266 width=0) (actual time=12001.342..14960.165 rows=1002793 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=4382380 width=4) (actual time=0.018..1234.496 rows=4384297 loops=1)
        Filter: (keyword_id < 75067)
        Rows Removed by Filter: 139633
  ->  Hash  (cost=912031.43..912031.43 rows=553473 width=8) (actual time=12000.331..12000.331 rows=305037 loops=1)
        Buckets: 131072  Batches: 8  Memory Usage: 2522kB
        ->  Hash Join  (cost=92735.26..912031.43 rows=553473 width=8) (actual time=9097.274..11912.867 rows=305037 loops=1)
              Hash Cond: (ci.movie_id = t.id)
              ->  Seq Scan on cast_info ci  (cost=0.00..796071.18 rows=913652 width=4) (actual time=8184.202..10503.913 rows=394483 loops=1)
                    Filter: ((person_id < 2923020) AND (role_id = 9))
                    Rows Removed by Filter: 35849861
              ->  Hash  (cost=67604.59..67604.59 rows=1531734 width=4) (actual time=912.161..912.161 rows=1531613 loops=1)
                    Buckets: 131072  Batches: 32  Memory Usage: 2708kB
                    ->  Seq Scan on title t  (cost=0.00..67604.59 rows=1531734 width=4) (actual time=0.020..610.849 rows=1531613 loops=1)
                          Filter: (production_year > 1997)
                          Rows Removed by Filter: 996699
Planning time: 0.788 ms
Execution time: 15059.789 ms
