Hash Join  (cost=179243.31..694438.24 rows=740780 width=0) (actual time=2981.868..13713.359 rows=236610 loops=1)
  Hash Cond: (mi.movie_id = t.id)
  ->  Seq Scan on movie_info mi  (cost=0.00..346232.03 rows=13926693 width=4) (actual time=0.019..6230.272 rows=13963496 loops=1)
        Filter: (info_type_id < 98)
        Rows Removed by Filter: 872224
  ->  Hash  (cost=177036.11..177036.11 rows=134496 width=8) (actual time=2871.154..2871.154 rows=28058 loops=1)
        Buckets: 131072  Batches: 2  Memory Usage: 1583kB
        ->  Hash Join  (cost=86573.65..177036.11 rows=134496 width=8) (actual time=1944.013..2860.623 rows=28058 loops=1)
              Hash Cond: (mk.movie_id = t.id)
              ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=441165 width=4) (actual time=0.028..1145.253 rows=453330 loops=1)
                    Filter: (keyword_id < 348)
                    Rows Removed by Filter: 4070600
              ->  Hash  (cost=73925.90..73925.90 rows=770860 width=4) (actual time=1374.196..1374.196 rows=682281 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 2528kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=770860 width=4) (actual time=0.024..1148.673 rows=682281 loops=1)
                          Filter: ((production_year < 2004) AND (kind_id = 7))
                          Rows Removed by Filter: 1846031
Planning time: 1.351 ms
Execution time: 13742.179 ms
