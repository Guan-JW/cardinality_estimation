Hash Join  (cost=146985.82..908642.12 rows=1086714 width=0) (actual time=2818.487..22477.331 rows=815875 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..614943.12 rows=36225612 width=4) (actual time=0.015..8610.414 rows=36244344 loops=1)
  ->  Hash  (cost=146037.67..146037.67 rows=75852 width=8) (actual time=2817.527..2817.527 rows=54632 loops=1)
        Buckets: 131072  Batches: 1  Memory Usage: 3159kB
        ->  Hash Join  (cost=79422.14..146037.67 rows=75852 width=8) (actual time=1649.109..2795.085 rows=54632 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=572552 width=4) (actual time=360.558..1081.870 rows=864195 loops=1)
                    Filter: ((company_id > 13486) AND (company_type_id > 1))
                    Rows Removed by Filter: 1744934
              ->  Hash  (cost=73925.90..73925.90 rows=334979 width=4) (actual time=1287.595..1287.595 rows=198988 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 1894kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=334979 width=4) (actual time=0.569..1222.115 rows=198988 loops=1)
                          Filter: ((kind_id > 1) AND (production_year < 1976))
                          Rows Removed by Filter: 2329324
Planning time: 1.147 ms
Execution time: 22589.817 ms
