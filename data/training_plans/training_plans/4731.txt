Hash Join  (cost=140346.56..896023.58 rows=488786 width=0) (actual time=2715.649..21370.985 rows=827124 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..614943.12 rows=36225612 width=4) (actual time=0.011..9131.638 rows=36244344 loops=1)
  ->  Hash  (cost=139920.10..139920.10 rows=34117 width=8) (actual time=2715.164..2715.164 rows=24512 loops=1)
        Buckets: 65536  Batches: 1  Memory Usage: 1470kB
        ->  Hash Join  (cost=75220.98..139920.10 rows=34117 width=8) (actual time=1197.270..2705.709 rows=24512 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..51404.11 rows=1093556 width=4) (actual time=0.020..960.596 rows=1086400 loops=1)
                    Filter: (company_id < 7126)
                    Rows Removed by Filter: 1522729
              ->  Hash  (cost=73925.90..73925.90 rows=78886 width=4) (actual time=1196.162..1196.162 rows=74127 loops=1)
                    Buckets: 131072  Batches: 2  Memory Usage: 2328kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=78886 width=4) (actual time=0.245..1167.373 rows=74127 loops=1)
                          Filter: ((kind_id < 4) AND (production_year > 2011))
                          Rows Removed by Filter: 2454185
Planning time: 1.190 ms
Execution time: 21486.514 ms
