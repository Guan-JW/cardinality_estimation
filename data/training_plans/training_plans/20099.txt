Hash Join  (cost=173937.87..981578.00 rows=1563053 width=0) (actual time=13155.764..20791.878 rows=1274353 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=7298253 width=4) (actual time=9211.351..13363.894 rows=7451973 loops=1)
        Filter: (role_id = 2)
        Rows Removed by Filter: 28792371
  ->  Hash  (cost=165052.74..165052.74 rows=541530 width=8) (actual time=3942.997..3942.997 rows=404362 loops=1)
        Buckets: 131072  Batches: 8  Memory Usage: 3009kB
        ->  Hash Join  (cost=82536.92..165052.74 rows=541530 width=8) (actual time=1480.555..3813.298 rows=404362 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..44881.29 rows=2609129 width=4) (actual time=0.028..965.287 rows=2609129 loops=1)
              ->  Hash  (cost=73925.90..73925.90 rows=524801 width=4) (actual time=1479.697..1479.697 rows=386160 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 2711kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=524801 width=4) (actual time=0.028..1351.022 rows=386160 loops=1)
                          Filter: ((kind_id > 1) AND (production_year < 1991))
                          Rows Removed by Filter: 2142152
Planning time: 1.215 ms
Execution time: 20910.903 ms
