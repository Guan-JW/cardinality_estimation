Nested Loop  (cost=178277.33..203235.32 rows=4451 width=0) (actual time=2425.954..2604.876 rows=1479 loops=1)
  Join Filter: (mc.movie_id = t.id)
  ->  Merge Join  (cost=178276.90..180418.26 rows=23396 width=8) (actual time=2425.820..2581.612 rows=1479 loops=1)
        Merge Cond: (mk.movie_id = mc.movie_id)
        ->  Sort  (cost=117937.29..118810.45 rows=349264 width=4) (actual time=1667.223..1769.854 rows=361777 loops=1)
              Sort Key: mk.movie_id
              Sort Method: external merge  Disk: 4976kB
              ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=349264 width=4) (actual time=0.021..1297.145 rows=363692 loops=1)
                    Filter: (keyword_id < 335)
                    Rows Removed by Filter: 4160238
        ->  Sort  (cost=60339.60..60420.15 rows=32221 width=4) (actual time=758.250..759.572 rows=6996 loops=1)
              Sort Key: mc.movie_id
              Sort Method: quicksort  Memory: 501kB
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=32221 width=4) (actual time=13.114..755.610 rows=6578 loops=1)
                    Filter: ((company_id = 6) AND (company_type_id = 2))
                    Rows Removed by Filter: 2602551
  ->  Index Only Scan using title_pkey on title t  (cost=0.43..0.96 rows=1 width=4) (actual time=0.015..0.015 rows=1 loops=1479)
        Index Cond: (id = mk.movie_id)
        Heap Fetches: 1479
Planning time: 1.224 ms
Execution time: 2607.506 ms
