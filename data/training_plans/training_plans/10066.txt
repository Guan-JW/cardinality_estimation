Hash Join  (cost=159731.95..276161.21 rows=230155 width=0) (actual time=3330.316..6908.618 rows=3332880 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=2794289 width=4) (actual time=0.012..1617.936 rows=2784381 loops=1)
        Filter: (keyword_id > 2839)
        Rows Removed by Filter: 1739549
  ->  Hash  (cost=156314.64..156314.64 rows=208265 width=8) (actual time=3329.453..3329.453 rows=458238 loops=1)
        Buckets: 131072 (originally 131072)  Batches: 8 (originally 4)  Memory Usage: 3291kB
        ->  Hash Join  (cost=83958.69..156314.64 rows=208265 width=8) (actual time=1431.182..3189.443 rows=458238 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=861163 width=4) (actual time=0.014..1037.478 rows=1066811 loops=1)
                    Filter: ((company_id > 3139) AND (company_type_id = 2))
                    Rows Removed by Filter: 1542318
              ->  Hash  (cost=73925.90..73925.90 rows=611503 width=4) (actual time=1430.239..1430.239 rows=511129 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 3286kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=611503 width=4) (actual time=600.976..1274.449 rows=511129 loops=1)
                          Filter: ((production_year > 1941) AND (kind_id = 1))
                          Rows Removed by Filter: 2017183
Planning time: 0.812 ms
Execution time: 7290.556 ms
