Hash Join  (cost=221699.77..1342287.14 rows=8448021 width=0) (actual time=5989.906..52898.562 rows=73947676 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..614943.12 rows=36225612 width=4) (actual time=0.022..13425.520 rows=36244344 loops=1)
  ->  Hash  (cost=212024.93..212024.93 rows=589667 width=8) (actual time=5988.611..5988.611 rows=1794809 loops=1)
        Buckets: 131072 (originally 131072)  Batches: 32 (originally 8)  Memory Usage: 3188kB
        ->  Hash Join  (cost=80493.69..212024.93 rows=589667 width=8) (actual time=1417.558..5468.321 rows=1794809 loops=1)
              Hash Cond: (mk.movie_id = t.id)
              ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=3724651 width=4) (actual time=0.016..1692.651 rows=3719060 loops=1)
                    Filter: (keyword_id < 23022)
                    Rows Removed by Filter: 804870
              ->  Hash  (cost=73925.90..73925.90 rows=400303 width=4) (actual time=1416.780..1416.780 rows=500611 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 3243kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=400303 width=4) (actual time=0.027..1251.898 rows=500611 loops=1)
                          Filter: ((kind_id < 7) AND (production_year < 2000))
                          Rows Removed by Filter: 2027701
Planning time: 1.179 ms
Execution time: 60366.221 ms
