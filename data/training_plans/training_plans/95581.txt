Hash Join  (cost=159157.52..287344.90 rows=507634 width=0) (actual time=3338.197..4306.622 rows=209261 loops=1)
  Hash Cond: (mk.movie_id = t.id)
  ->  Seq Scan on movie_keyword mk  (cost=0.00..69693.30 rows=4523930 width=4) (actual time=0.028..859.550 rows=4523930 loops=1)
  ->  Hash  (cost=154501.92..154501.92 rows=283728 width=8) (actual time=2225.373..2225.373 rows=176688 loops=1)
        Buckets: 131072  Batches: 4  Memory Usage: 2759kB
        ->  Hash Join  (cost=82778.48..154501.92 rows=283728 width=8) (actual time=1145.208..2191.028 rows=176688 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..51404.11 rows=1329612 width=4) (actual time=148.125..659.283 rows=1334883 loops=1)
                    Filter: (company_type_id = 2)
                    Rows Removed by Filter: 1274246
              ->  Hash  (cost=73925.90..73925.90 rows=539566 width=4) (actual time=996.157..996.157 rows=428248 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 2890kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=539566 width=4) (actual time=0.024..862.704 rows=428248 loops=1)
                          Filter: ((production_year < 1997) AND (kind_id = 7))
                          Rows Removed by Filter: 2100064
Planning time: 1.133 ms
Execution time: 4324.084 ms
