Hash Join  (cost=844924.77..1427239.15 rows=973594 width=0) (actual time=16961.898..28827.903 rows=3245235 loops=1)
  Hash Cond: (mi.movie_id = t.id)
  ->  Seq Scan on movie_info mi  (cost=0.00..309384.22 rows=14739122 width=4) (actual time=0.018..4773.100 rows=14835720 loops=1)
  ->  Hash  (cost=842183.99..842183.99 rows=167022 width=8) (actual time=16961.155..16961.155 rows=247441 loops=1)
        Buckets: 131072  Batches: 4  Memory Usage: 3443kB
        ->  Hash Join  (cost=74251.74..842183.99 rows=167022 width=8) (actual time=633.621..16304.452 rows=247441 loops=1)
              Hash Cond: (ci.movie_id = t.id)
              ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=16201301 width=4) (actual time=0.019..11967.186 rows=16121683 loops=1)
                    Filter: (role_id > 2)
                    Rows Removed by Filter: 20122661
              ->  Hash  (cost=73925.90..73925.90 rows=26067 width=4) (actual time=633.408..633.408 rows=27085 loops=1)
                    Buckets: 32768  Batches: 1  Memory Usage: 1209kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=26067 width=4) (actual time=0.232..624.526 rows=27085 loops=1)
                          Filter: ((kind_id < 7) AND (production_year > 2012))
                          Rows Removed by Filter: 2501227
Planning time: 0.923 ms
Execution time: 29201.538 ms
