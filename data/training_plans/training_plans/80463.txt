Hash Join  (cost=210254.03..1336757.91 rows=9023975 width=0) (actual time=3758.569..29743.388 rows=5624521 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..614943.12 rows=36225612 width=4) (actual time=0.019..10536.208 rows=36244344 loops=1)
  ->  Hash  (cost=199919.68..199919.68 rows=629868 width=8) (actual time=3756.908..3756.908 rows=141499 loops=1)
        Buckets: 131072  Batches: 16  Memory Usage: 1375kB
        ->  Hash Join  (cost=89240.26..199919.68 rows=629868 width=8) (actual time=1432.296..3708.435 rows=141499 loops=1)
              Hash Cond: (mk.movie_id = t.id)
              ->  Seq Scan on movie_keyword mk  (cost=0.00..81003.12 rows=1706299 width=4) (actual time=0.025..1287.508 rows=1713678 loops=1)
                    Filter: (keyword_id < 2731)
                    Rows Removed by Filter: 2810252
              ->  Hash  (cost=73925.90..73925.90 rows=933388 width=4) (actual time=1431.152..1431.152 rows=1024206 loops=1)
                    Buckets: 131072  Batches: 16  Memory Usage: 3291kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=933388 width=4) (actual time=0.020..1097.646 rows=1024206 loops=1)
                          Filter: ((production_year > 1997) AND (kind_id = 7))
                          Rows Removed by Filter: 1504106
Planning time: 1.107 ms
Execution time: 30272.233 ms
