Hash Join  (cost=161638.71..1030499.69 rows=1204805 width=0) (actual time=3484.795..24540.535 rows=4881742 loops=1)
  Hash Cond: (ci.movie_id = t.id)
  ->  Seq Scan on cast_info ci  (cost=0.00..705507.15 rows=13006607 width=4) (actual time=0.031..13312.322 rows=13143420 loops=1)
        Filter: (person_id > 2361890)
        Rows Removed by Filter: 23100924
  ->  Hash  (cost=157795.99..157795.99 rows=234218 width=8) (actual time=3483.877..3483.877 rows=437127 loops=1)
        Buckets: 131072 (originally 131072)  Batches: 8 (originally 4)  Memory Usage: 3154kB
        ->  Hash Join  (cost=83743.23..157795.99 rows=234218 width=8) (actual time=1865.505..3333.626 rows=437127 loops=1)
              Hash Cond: (mc.movie_id = t.id)
              ->  Seq Scan on movie_companies mc  (cost=0.00..57926.93 rows=989772 width=4) (actual time=461.938..1154.655 rows=1148599 loops=1)
                    Filter: ((company_id > 964) AND (company_type_id = 2))
                    Rows Removed by Filter: 1460530
              ->  Hash  (cost=73925.90..73925.90 rows=598346 width=4) (actual time=1402.728..1402.728 rows=507407 loops=1)
                    Buckets: 131072  Batches: 8  Memory Usage: 3251kB
                    ->  Seq Scan on title t  (cost=0.00..73925.90 rows=598346 width=4) (actual time=0.020..1245.289 rows=507407 loops=1)
                          Filter: ((kind_id < 7) AND (production_year > 1997))
                          Rows Removed by Filter: 2020905
Planning time: 1.283 ms
Execution time: 25133.790 ms
